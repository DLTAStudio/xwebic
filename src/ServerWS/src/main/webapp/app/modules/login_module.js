"use strict";!function(){var a=angular.module("login-module",["ngMessages","ui.bootstrap","ws-module","shared-module"]);a.factory("callLoginWS",["callWS","sharedService",function(a,b){return function(c,d,e){var f=b.baseWS+"/token",g=[{name:"login",value:c},{name:"password",value:d}];a(f,"GET",g,null,function(a,b,c){e.onLoginSucceeded(a,b,c)},function(a,b,c){e.onLoginFailed(a,b,c)})}}]),a.controller("LoginCtrl",["callLoginWS","$scope","$translate","sharedService",function(a,b,c,d){this.message="",this.loading=!1,this.onLogin=function(){this.loading=!0,a(this.login,this.password,this)},this.onLoginSucceeded=function(a,c,e){var f=JSON.parse(c);d.setToken(f.token),this.loading=!1,b.$emit("loggedIn",!0)},this.onLoginFailed=function(a,d,e){var f=JSON.parse(d);f?this.message=c.instant(f.message):this.message=c.instant("SERVER_CONN_ERROR"),this.loading=!1,b.$emit("loggedIn",!1)}}])}();