function Integration(a,b,c,d,e,f,g,h,i,j,k){this.id=a,this.botName=b,this.number=c,this.startedTime=d,this.duration=e,this.currentStep=f,this.result=g,this.xcodebuildOutput="",this.buildServiceLog="",this.xcodebuildLog="",this.sourceControlLog="",this.getFormattedStartTime=function(){return this.startedTime.format("DD/MM/YYYY - h:mm:ss")},this.getFormattedDuration=function(){var a=moment.duration(this.duration,"seconds");return a.format("m [min] s [sec]")}}!function(){var a=angular.module("integration-module",["ngMessages","ui.bootstrap","ws-module","shared-module","chart.js"]);a.factory("callLoadBotIntegrationWS",["callWS","sharedService",function(a,b){return function(c,d){var e=b.baseWS+"/bots/"+d+"/integrations?summary_only",f=[{name:"token",value:b.getToken()}];a(e,"GET",f,null,function(a,b,d){var e=JSON.parse(b);e.results.forEach(function(a){startMoment=moment(a.startedTime);var b="",d="",f="",g="";void 0!=a.assets&&(void 0!=a.assets.xcodebuildOutput&&(b=a.assets.xcodebuildOutput.relativePath),void 0!=a.assets.buildServiceLog&&(d=a.assets.buildServiceLog.relativePath),void 0!=a.assets.xcodebuildLog&&(f=a.assets.xcodebuildLog.relativePath),void 0!=a.assets.sourceControlLog&&(g=a.assets.sourceControlLog.relativePath));var h=new Integration(a._id,a.bot.name,a.number,startMoment,a.duration,a.currentStep,a.result,b,d,f,g);if(c.integrations.push(h),void 0!=a.buildResultSummary){var i;i=e.results.length>10?"":a.number;var j=a.buildResultSummary.codeCoveragePercentage;c.coverage_labels.unshift(i),c.coverage_data[0].unshift(j);var k=a.buildResultSummary.testsCount,l=a.buildResultSummary.testFailureCount;c.tests_labels.unshift(i),c.tests_data[0].unshift(k),c.tests_data[1].unshift(l);var m=a.buildResultSummary.errorCount,n=a.buildResultSummary.warningCount;c.build_labels.unshift(i),c.build_data[0].unshift(m),c.build_data[1].unshift(n)}c.integrations.length>0&&(c.lastIntegrationResult=c.integrations[0].result)})},function(a,d,e){c.reset(),b.setToken(null)})}}]),a.factory("callPerformBotIntegrationWS",["callWS","sharedService","callLoadBotIntegrationWS",function(a,b,c){return function(c,d){var e=b.baseWS+"/bots/"+d+"/integrations",f=[{name:"token",value:b.getToken()}];a(e,"POST",f,null,function(a,b,d){c.onRefreshButton()},function(a,b,d){c.refresh()})}}]),a.factory("callLoadIntegrationAssetWS",["callWS","sharedService","callLoadBotIntegrationWS",function(a,b,c){return function(c,d){var e=b.baseWS+"/integrations/"+d+"/assets",f=[{name:"token",value:b.getToken()}];a(e,"GET",f,null,function(a,b,e){c.downloadAsset(b,e,d)},function(a,b,d){c.refresh()})}}]),a.controller("ListIntegrationCtrl",["callPerformBotIntegrationWS","callLoadBotIntegrationWS","callLoadIntegrationAssetWS","sharedService","$scope","$translate",function(a,b,c,d,e,f){this.reset=function(){this.lastIntegrationResult="N/A",this.integrations=[],this.botId="",this.coverage_labels=[],this.coverage_series=[f.instant("Coverage")],this.coverage_data=[[]],this.tests_labels=[],this.tests_series=[f.instant("Tests Count"),f.instant("Test Failure count")],this.tests_data=[[],[]],this.build_labels=[],this.build_series=[f.instant("Build errors"),f.instant("Build warnings")],this.build_data=[[],[]]},this.reset();var g=this;e.$on("botselected",function(a,c){g.reset(),g.botId=c.id,b(g,g.botId)}),this.refresh=function(){this.integrations=[],b(this,this.botId)},this.onIntegrateButton=function(){a(g,g.botId)},this.onRefreshButton=function(){this.refresh()},this.getIntegrationURL=function(a){return d.baseWS+"/integrations/"+a.id+"/assets/"+d.getToken()},this.statusColorStyle=function(a){if(void 0==a){if(0==g.integrations.length)return"";a=g.integrations[0].result}var b="rgba(135,255,99, 0.8)",c="rgba(255,66,70, 0.8)",d="rgba(255, 215, 37, 0.8)";switch(a){case"succeeded":return{color:b,"font-weight":"bold"};case"test-failures":return{color:d,"font-weight":"bold"};case"build-errors":return{color:c,"font-weight":"bold"};case"warnings":return{color:d,"font-weight":"bold"};case"analyzer-warnings":return{color:d,"font-weight":"bold"};case"build-failed":return{color:c,"font-weight":"bold"};case"checkout-error":return{color:c,"font-weight":"bold"};case"internal-error":return{color:c,"font-weight":"bold"};case"internal-checkout-error":return{color:c,"font-weight":"bold"};case"internal-build-error":return{color:c,"font-weight":"bold"};case"internal-processing-error":return{color:c,"font-weight":"bold"};case"canceled":return{color:c,"font-weight":"bold"};case"trigger-error":return{color:c,"font-weight":"bold"};case"unknown":return{color:c,"font-weight":"bold"}}}}])}();